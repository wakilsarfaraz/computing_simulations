function [p,t] = sample_nodes(cx,cy,ze,zm,xmax,density)
% default values:  cx=1; cy=0; ze=0.5; zm=1;
% edge_weight = 0.01; 
edge_weight = 0.01; 
imp_elec = 0.6; % [0:1] 

% fd=@(p) ddiff(drectangle(p,0,xmax,0,xmax),min(min(dcircle(p,cx,cy,0.1),...
%     drectangle(p,0.05,0.1,ze,zm)), drectangle(p,0.8,0.85,ze,zm)));
% fh = @(p) edge_weight+density*min(min(imp_elec*dcircle(p,cx,cy,0.1),...
%     drectangle(p,0.05,0.1,ze,zm)),drectangle(p,0.8,0.85,ze,zm));
% 
fd=@(p) ddiff(drectangle(p,0,xmax,0,xmax),min(min(min(min(min(min(min(min(min...
    (min(min(min(min(min(min(min(min...
    (min(min(min(min(min(min(min(dcircle(p,cx,cy,0.4) ,...
    drectangle(p,1,xmax-1,ze,ze) ), drectangle(p,1,xmax-1,zm,zm)),...
    drectangle(p,1.2,1.5,ze+0.5,zm-0.5)),drectangle(p,3.5,3.8,ze+0.5,zm-0.5)),...
    dcircle(p,2.5,0.5,0.2)),dcircle(p,2.5,4.5,0.2)),dcircle(p,0.5,2.5,0.2)),...
    dcircle(p,4.5,2.5,0.2)),drectangle(p,0,0,0,xmax)),drectangle(p,xmax,xmax,0,xmax)),...
    drectangle(p,0,xmax,0,0)),dcircle(p,0.5,0.5,0.3)),dcircle(p,4.5,0.5,0.3)),...
    dcircle(p,4.5,4.5,0.3)),dcircle(p,0.5,4.5,0.3)),drectangle(p,0,xmax,xmax,xmax)),...
    dcircle(p,1.5,4.5,0)),dcircle(p,3.5,0.5,0)),dcircle(p,3.5,4.5,0)),...
    dcircle(p,1.5,0.5,0)),dcircle(p,0.5,1.5,0)),dcircle(p,0.5,3.5,0)),dcircle(p,4.5,1.5,0)),...
    dcircle(p,4.5,3.5,0)));

fh = @(p) edge_weight+density*min(min(min(min(min(min(min(min(min(min(min(min(min(min(min(min...
    (min(min(min(min(min(min(min(min(imp_elec*dcircle(p,cx,cy,0.4),...
    drectangle(p,1,xmax-1,ze,ze)),drectangle(p,1,xmax-1,zm,zm))...
    ,drectangle(p,1.2,1.5,ze+0.5,zm-0.5)),drectangle(p,3.5,3.8,ze+0.5,zm-0.5)),...
    dcircle(p,2.5,0.5,0.2)),dcircle(p,2.5,4.5,0.2)),dcircle(p,0.5,2.5,0.2)),...
    dcircle(p,4.5,2.5,0.2)),drectangle(p,0,0,0,xmax)),drectangle(p,xmax,xmax,0,xmax)),...
    drectangle(p,0,xmax,0,0)),dcircle(p,0.5,0.5,0.3)),dcircle(p,4.5,0.5,0.3)),...
    dcircle(p,4.5,4.5,0.3)),dcircle(p,0.5,4.5,0.3)),drectangle(p,0,xmax,xmax,xmax)),...
    dcircle(p,1.5,4.5,0)),dcircle(p,3.5,0.5,0)),dcircle(p,3.5,4.5,0)),...
    dcircle(p,1.5,0.5,0)),dcircle(p,0.5,1.5,0)),dcircle(p,0.5,3.5,0)),...
    dcircle(p,4.5,1.5,0)),dcircle(p,4.5,3.5,0));

% fd=@(p) ddiff(drectangle(p,0,5,0,5),min(min(drectangle(p,0,cx,cy,cy) ,...
% drectangle(p,0,5,ze,ze) ), drectangle(p,0,5,zm,zm) ));
% fh = @(p) edge_weight+density*min(min(imp_elec*drectangle(p,0,cx,cy,cy),...
% drectangle(p,0,5,ze,ze)),drectangle(p,0,5,zm,zm));

[p,t]=distmesh2d(fd,fh,edge_weight,[0,0;xmax,xmax],[0,0;0,xmax;xmax,0;xmax,xmax]);

end

